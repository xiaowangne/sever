/* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{t as a}from"./tool.8164259c.js";import"./el-form-item.c6f666bf.js";import{f as e,x as t,w as s,g as l,h as o,j as d,a3 as n,A as r,y as u,z as i,a4 as p,a5 as c,B as m,a6 as f,a7 as g,o as h,m as y,n as b,D as v,F as k,I as w,a8 as C,J as _,G as I,ac as z,H as j,t as x,c as A}from"./vendor.555231f0.js";const V={class:"type-list"},S={class:"seach-section"},L={class:"create-type"},$=j("添加轮播图"),B=j("删除选择"),M=j("查询"),U={class:"type-list-table"},D=["src"],E=j("编辑 "),T=j("启用 "),q=j("冻结 "),F=j("删除 "),G={class:"pagination-box"};var H=e({name:"BannerList",setup(e){const H=t(),{proxy:J}=s(),N=J.$serverUrl;l([]);const R=o({title:"",typeId:"-1",status:"-1"}),K=l({}),O=o({total:0,pagerCount:5,pageSize:10,pageArray:[2,5,10,20,30,50,100,200],offset:0}),P=l([]),Q=a=>{O.offset=0,O.pageSize=a,ea()},W=a=>{O.offset=(a-1)*O.pageSize,ea()},X=l([]),Y=l([]);d((()=>{aa(),sa()}));const Z=n((()=>P.value.length>0)),aa=()=>{O.total=0,O.offset=0,K.value=R,ta(),ea()},ea=()=>{let e={offset:O.offset,count:O.pageSize};for(let a in R)("status"!=a&&"typeId"!=a||"-1"!=R[a])&&R[a]&&(e[a]=R[a]);J.$axios.get("/bannerList",{params:e,headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1280==e.data.status&&(e.data.data.forEach((e=>{e.createdAt=a.formatDate(e.createdAt,"yyyy-MM-dd hh:mm:ss"),e.updatedAt=a.formatDate(e.updatedAt,"yyyy-MM-dd hh:mm:ss")})),X.value=e.data.data,ta())})).catch((a=>{console.log("error",a)}))},ta=()=>{let a={};for(let e in K.value)("status"!=e&&"typeId"!=e||"-1"!=K.value[e])&&K.value[e]&&(a[e]=K.value[e]);J.$axios.get("/bannerCount",{params:a,headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1300==a.data.status&&(O.total=a.data.data[0].count)})).catch((a=>{console.log("error",a)}))},sa=()=>{J.$axios.get("/bannerType",{headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1230==a.data.status&&(Y.value=a.data.data)})).catch((a=>{console.log("error",a)}))},la=a=>{J.$axios({method:"post",url:"/bannerStatus",data:{typeId:a.typeId,banId:a.banId,status:0==a.status?1:0},headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1290==e.data.status&&1==e.data.data.result[0]?(_({message:e.data.msg,showClose:!0,type:"success"}),a.status=e.data.data.status):_({message:e.data.msg,type:"error",showClose:!0})})).catch((a=>{console.log("err ==> ",a)}))},oa=a=>{P.value=[],a.forEach((a=>{P.value.push(a.banId)}))},da=a=>{J.$axios({method:"post",url:"/removeBanner",data:{banIds:a},headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1330==a.data.status?(_({message:a.data.msg,showClose:!0,type:"success"}),X.value=[],aa()):_({message:a.data.msg,type:"error",showClose:!0})})).catch((a=>{console.log("err ==> ",a)}))},na=()=>{da(P.value)},ra=()=>{H.push({name:"AddBanner"})};return(a,e)=>{const t=r,s=u,l=i,o=p,d=c,n=m,_=f,J=g;return h(),y("div",V,[b("div",S,[b("div",L,[v(t,{type:"primary",onClick:ra},{default:k((()=>[$])),_:1}),v(t,{type:"danger",disabled:!w(Z),onClick:na},{default:k((()=>[B])),_:1},8,["disabled"])]),v(n,{inline:!0,model:R,class:"demo-form-inline"},{default:k((()=>[v(l,{label:"标题"},{default:k((()=>[v(s,{modelValue:R.title,"onUpdate:modelValue":e[0]||(e[0]=a=>R.title=a),placeholder:"输入标题"},null,8,["modelValue"])])),_:1}),v(l,{label:"类型"},{default:k((()=>[v(d,{modelValue:R.typeId,"onUpdate:modelValue":e[1]||(e[1]=a=>R.typeId=a),placeholder:"选择类型"},{default:k((()=>[v(o,{label:"选择类型",value:"-1"}),(h(!0),y(I,null,z(Y.value,(a=>(h(),A(o,{label:a.title,value:a.typeId,key:a.typeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(l,{label:"状态"},{default:k((()=>[v(d,{modelValue:R.status,"onUpdate:modelValue":e[2]||(e[2]=a=>R.status=a),placeholder:"选择状态"},{default:k((()=>[v(o,{label:"选择状态",value:"-1"}),v(o,{label:"正常",value:"0"}),v(o,{label:"冻结",value:"1"})])),_:1},8,["modelValue"])])),_:1}),v(l,null,{default:k((()=>[v(t,{type:"primary",onClick:ea},{default:k((()=>[M])),_:1})])),_:1})])),_:1},8,["model"])]),b("div",U,[v(w(C),{ref:"multipleTableRef",data:X.value,onSelectionChange:oa},{default:k((()=>[v(_,{type:"selection",width:"55"}),v(_,{prop:"typeName",label:"类型",width:"120"}),v(_,{property:"title",label:"标题",width:"120"}),v(_,{property:"status",label:"状态",width:"120","show-overflow-tooltip":""},{default:k((a=>[j(x(0==a.row.status?"正常":"冻结"),1)])),_:1}),v(_,{label:"更新时间",width:"180"},{default:k((a=>[j(x(a.row.createdAt),1)])),_:1}),v(_,{label:"图片",width:"180"},{default:k((a=>[b("img",{src:""==a.row.img?"/src/assets/images/nopic.png":w(N)+"/"+a.row.img},null,8,D)])),_:1}),v(_,{label:"操作"},{default:k((a=>[v(t,{size:"small",type:"default",plain:"",onClick:e=>{return t=a.row.banId,void H.push({name:"AddBanner",query:{banId:t}});var t}},{default:k((()=>[E])),_:2},1032,["onClick"]),1==a.row.status?(h(),A(t,{key:0,size:"small",type:"success",plain:"",onClick:e=>la(a.row)},{default:k((()=>[T])),_:2},1032,["onClick"])):(h(),A(t,{key:1,size:"small",type:"warning",plain:"",onClick:e=>la(a.row)},{default:k((()=>[q])),_:2},1032,["onClick"])),v(t,{size:"small",type:"danger",plain:"",onClick:e=>{return t=a.row.banId,void da([t]);var t}},{default:k((()=>[F])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),b("div",G,[v(J,{background:"","pager-count":O.pagerCount,"page-size":O.pageSize,"page-sizes":O.pageArray,layout:"total, sizes, prev, pager, next, jumper",total:O.total,onSizeChange:Q,onCurrentChange:W},null,8,["pager-count","page-size","page-sizes","total"])])])])}}});export{H as default};
