/* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{t as e}from"./tool.8164259c.js";import"./el-form-item.c6f666bf.js";import{f as a,x as t,w as s,h as l,g as o,j as r,a3 as u,A as d,y as i,z as n,a4 as p,a5 as c,B as m,a6 as f,a7 as y,o as g,m as h,n as v,D as k,F as w,I as C,a8 as b,J as _,H as z,t as A,c as j}from"./vendor.555231f0.js";const x={class:"type-list"},I={class:"seach-section"},S={class:"create-type"},T=z("添加文章分类"),L=z("删除选择"),V=z("查询"),$={class:"type-list-table"},M=["src"],D=z("编辑 "),U=z("启用 "),E=z("冻结 "),q=z("删除 "),B={class:"pagination-box"};var F=a({name:"ArticleTypeList",setup(a){const F=t(),{proxy:H}=s(),J=H.$serverUrl,R=l({title:"",status:"-1"}),G=o({}),K=l({total:0,pagerCount:5,pageSize:10,pageArray:[2,5,10,20,30,50,100,200],offset:0}),N=o([]),O=o([]);r((()=>{Q()}));const P=u((()=>N.value.length>0)),Q=()=>{K.total=0,K.offset=0,G.value=R,ae(),W()},W=()=>{let a={offset:K.offset,count:K.pageSize};for(let e in G.value)"status"==e&&"-1"==G.value[e]||!G.value[e]||(a[e]=G.value[e]);H.$axios.get("/typeList",{params:a,headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return F.push({name:"Login"});1060==a.data.status&&(a.data.data.forEach((a=>{a.createdAt=e.formatDate(a.createdAt,"yyyy-MM-dd hh:mm:ss"),a.updatedAt=e.formatDate(a.updatedAt,"yyyy-MM-dd hh:mm:ss")})),O.value=a.data.data,ae())})).catch((e=>{console.log("error",e)}))},X=e=>{H.$axios({method:"post",url:"/typeStatus",data:{typeId:e.typeId,status:0==e.status?1:0,type:"ArticleType"},headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return F.push({name:"Login"});1070==a.data.status&&1==a.data.data.result[0]?(_({message:a.data.msg,showClose:!0,type:"success"}),e.status=a.data.data.status):_({message:a.data.msg,type:"error",showClose:!0})})).catch((e=>{console.log("err ==> ",e)}))},Y=e=>{N.value=[],e.forEach((e=>{N.value.push(e.typeId)}))},Z=e=>{H.$axios({method:"post",url:"/removeType",data:{typeIds:e,type:"ArticleType"},headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return F.push({name:"Login"});1100==e.data.status?(_({message:e.data.msg,showClose:!0,type:"success"}),O.value=[],Q()):_({message:e.data.msg,type:"error",showClose:!0})})).catch((e=>{console.log("err ==> ",e)}))},ee=()=>{Z(N.value)},ae=()=>{let e={};for(let a in G.value)"status"==a&&"-1"==G.value[a]||!G.value[a]||(e[a]=G.value[a]);H.$axios.get("/typeCount",{params:e,headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return F.push({name:"Login"});1110==e.data.status&&(K.total=e.data.data[0].count)})).catch((e=>{console.log("error",e)}))},te=e=>{K.offset=0,K.pageSize=e,W()},se=e=>{K.offset=(e-1)*K.pageSize,W()},le=()=>{F.push({name:"ArticleType"})};return(e,a)=>{const t=d,s=i,l=n,o=p,r=c,u=m,_=f,H=y;return g(),h("div",x,[v("div",I,[v("div",S,[k(t,{type:"primary",onClick:le},{default:w((()=>[T])),_:1}),k(t,{type:"danger",disabled:!C(P),onClick:ee},{default:w((()=>[L])),_:1},8,["disabled"])]),k(u,{inline:!0,model:R,class:"demo-form-inline"},{default:w((()=>[k(l,{label:"类型名称"},{default:w((()=>[k(s,{modelValue:R.title,"onUpdate:modelValue":a[0]||(a[0]=e=>R.title=e),placeholder:"输入类型名称"},null,8,["modelValue"])])),_:1}),k(l,{label:"状态"},{default:w((()=>[k(r,{modelValue:R.status,"onUpdate:modelValue":a[1]||(a[1]=e=>R.status=e),placeholder:"输入状态"},{default:w((()=>[k(o,{label:"选择状态",value:"-1"}),k(o,{label:"正常",value:"0"}),k(o,{label:"冻结",value:"1"})])),_:1},8,["modelValue"])])),_:1}),k(l,null,{default:w((()=>[k(t,{type:"primary",onClick:Q},{default:w((()=>[V])),_:1})])),_:1})])),_:1},8,["model"])]),v("div",$,[k(C(b),{ref:"multipleTableRef",data:O.value,onSelectionChange:Y},{default:w((()=>[k(_,{type:"selection",width:"55"}),k(_,{property:"title",label:"名称",width:"120"}),k(_,{property:"status",label:"状态",width:"120","show-overflow-tooltip":""},{default:w((e=>[z(A(0==e.row.status?"正常":"冻结"),1)])),_:1}),k(_,{label:"更新时间",width:"180"},{default:w((e=>[z(A(e.row.createdAt),1)])),_:1}),k(_,{label:"图片",width:"180"},{default:w((e=>[v("img",{src:""==e.row.img?"/src/assets/images/nopic.png":C(J)+"/"+e.row.img},null,8,M)])),_:1}),k(_,{label:"操作"},{default:w((e=>[k(t,{size:"small",type:"default",plain:"",onClick:a=>{return t=e.row.typeId,void F.push({name:"ArticleType",query:{typeId:t}});var t}},{default:w((()=>[D])),_:2},1032,["onClick"]),1==e.row.status?(g(),j(t,{key:0,size:"small",type:"success",plain:"",onClick:a=>X(e.row)},{default:w((()=>[U])),_:2},1032,["onClick"])):(g(),j(t,{key:1,size:"small",type:"warning",plain:"",onClick:a=>X(e.row)},{default:w((()=>[E])),_:2},1032,["onClick"])),k(t,{size:"small",type:"danger",plain:"",onClick:a=>{return t=e.row.typeId,void Z([t]);var t}},{default:w((()=>[q])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),v("div",B,[k(H,{background:"","pager-count":K.pagerCount,"page-size":K.pageSize,"page-sizes":K.pageArray,layout:"total, sizes, prev, pager, next, jumper",total:K.total,onSizeChange:te,onCurrentChange:se},null,8,["pager-count","page-size","page-sizes","total"])])])])}}});export{F as default};
